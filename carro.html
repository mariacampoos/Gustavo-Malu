<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Valinhos</title>

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      overflow: hidden;
      min-height: 100vh;
      background: #f0f0f0;
    }

    header {
      background: #6A1B9A;
      color: white;
      text-align: center;
      padding: 20px;
      user-select: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
    }

    nav.navbar {
      position: fixed;
      top: 70px; /* logo + header + margem */
      left: 0;
      right: 0;
      height: 50px;
      background-color: #8e24aa;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 100;
    }

    nav.navbar .nav-link {
      color: white;
      font-weight: 500;
      text-decoration: none;
      font-size: 1.1em;
      padding: 8px 16px;
      border-radius: 8px;
      transition: background-color 0.3s;
    }

    nav.navbar .nav-link:hover {
      background-color: #6a1b9a;
    }

    #car {
      position: fixed;
      width: 60px;
      height: 60px;
      z-index: 101;
      user-select: none;
      /* A posi√ß√£o ser√° atualizada via JS */
    }

    #car img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      pointer-events: none;
      user-select: none;
    }

    #finish-line {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 10px;
      height: 80px;
      background: repeating-linear-gradient(
        45deg,
        #6A1B9A,
        #6A1B9A 10px,
        #ffffff 10px,
        #ffffff 20px
      );
      border-radius: 4px;
      box-shadow: 0 0 10px #6A1B9A;
      user-select: none;
      z-index: 50;
    }

    #start-line {
      position: fixed;
      left: 20px;
      width: 10px;
      height: 80px;
      background: repeating-linear-gradient(
        45deg,
        #BA68C8,
        #BA68C8 10px,
        #ffffff 10px,
        #ffffff 20px
      );
      border-radius: 4px;
      box-shadow: 0 0 10px #BA68C8;
      user-select: none;
      z-index: 50;
      /* Posi√ß√£o ajustada dinamicamente no JS */
    }

    #message-finish {
      position: fixed;
      bottom: 120px;
      right: 20px;
      background: #6A1B9A;
      color: white;
      padding: 15px 25px;
      border-radius: 12px;
      font-size: 1.3em;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(106, 27, 154, 0.8);
      opacity: 0;
      pointer-events: none;
      user-select: none;
      z-index: 60;
      transition: opacity 0.5s ease-in-out;
    }

    #message-finish.show {
      opacity: 1;
      pointer-events: auto;
    }

    #controls {
      display: none;
      position: fixed;
      bottom: 15px;
      right: 20px;
      z-index: 100;
      user-select: none;
    }

    #controls button {
      font-size: 1.8em;
      margin: 5px;
      padding: 10px 15px;
      background: #8e24aa;
      border: none;
      color: white;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s;
      width: 50px;
      height: 50px;
    }

    #controls button:active {
      background-color: #6a1b9a;
    }

    @media (max-width: 768px) {
      #controls {
        display: block;
      }
    }
  </style>
</head>
<body>

  <header>
    <h1>Jogue e Ganhe um Vale</h1>
    <p>Nosso amor acelera mais forte que qualquer carrinho ‚Äî e nunca freia</p>
  </header>

  <nav class="navbar">
    <a href="#" class="nav-link">Sobre n√≥s</a>
  </nav>

  <div id="start-line"></div>
  <div id="car">
    <img src="https://i.imgur.com/6nGz0Kj.png" alt="Carrinho de corrida" />
  </div>

  <div id="finish-line"></div>
  <div id="message-finish"></div>

  <div id="controls">
    <button onclick="mover('up')">‚ñ≤</button><br />
    <button onclick="mover('left')">‚óÑ</button>
    <button onclick="mover('down')">‚ñº</button>
    <button onclick="mover('right')">‚ñ∫</button>
  </div>

  <script>
    const car = document.getElementById('car');
    const finish = document.getElementById('finish-line');
    const start = document.getElementById('start-line');
    const message = document.getElementById('message-finish');

    const velocidade = 10;
    const carSize = 60;

    // Ajusta a posi√ß√£o do start-line para ficar abaixo do header e nav
    function ajustarPosicoes() {
      const header = document.querySelector('header');
      const nav = document.querySelector('nav.navbar');

      const headerRect = header.getBoundingClientRect();
      const navRect = nav.getBoundingClientRect();

      const topInicial = navRect.bottom + 20; // 20px de margem abaixo do nav

      start.style.top = topInicial + 'px';
      start.style.height = '80px';

      // Atualiza posi√ß√£o inicial do carrinho
      posX = start.getBoundingClientRect().left + start.offsetWidth / 2;
      posY = topInicial + start.offsetHeight / 2;

      atualizarPosicao();
    }

    // Posi√ß√£o inicial do carrinho
    let posX = 0;
    let posY = 0;

    function atualizarPosicao() {
      // Limite para o carrinho n√£o passar do lado direito (evitando passar sobre bot√µes)
      let limiteDireito = window.innerWidth - 100; // 100px reservado para bot√µes no celular

      // Aplica limites nos eixos
      posX = Math.min(limiteDireito, Math.max(0, posX));
      posY = Math.min(window.innerHeight - carSize, Math.max( (start.getBoundingClientRect().bottom), posY));

      car.style.left = (posX - carSize / 2) + 'px';
      car.style.top = (posY - carSize / 2) + 'px';

      checarChegada();
    }

    // Fun√ß√£o para mover o carrinho
    function mover(direcao) {
      if (direcao === 'up') posY -= velocidade;
      else if (direcao === 'down') posY += velocidade;
      else if (direcao === 'left') posX -= velocidade;
      else if (direcao === 'right') posX += velocidade;
      atualizarPosicao();
    }

    // Teclado para desktop
    let teclas = {ArrowUp:false, ArrowDown:false, ArrowLeft:false, ArrowRight:false};

    document.addEventListener('keydown', e => {
      if (e.key in teclas) teclas[e.key] = true;
    });
    document.addEventListener('keyup', e => {
      if (e.key in teclas) teclas[e.key] = false;
    });

    function moverComTeclado() {
      if (teclas.ArrowUp) mover('up');
      if (teclas.ArrowDown) mover('down');
      if (teclas.ArrowLeft) mover('left');
      if (teclas.ArrowRight) mover('right');
      requestAnimationFrame(moverComTeclado);
    }

    // Checar se chegou na linha de chegada
    function checarChegada() {
      const finishRect = finish.getBoundingClientRect();
      const carRect = car.getBoundingClientRect();

      if (
        carRect.left + carRect.width / 2 >= finishRect.left &&
        carRect.left + carRect.width / 2 <= finishRect.right &&
        carRect.top + carRect.height / 2 >= finishRect.top &&
        carRect.top + carRect.height / 2 <= finishRect.bottom
      ) {
        mostrarMensagem();
      } else {
        esconderMensagem();
      }
    }

    let ultimaMensagem = -1;
    const cupons = [
      "Vale um cinema! üçø",
      "Vale um lanche! üçî",
      "Vale abra√ßos Ilimitados! ü§ó",
      "Vale um jantar rom√¢ntico! üçù",
      "Vale uma massagem relaxante! üíÜ‚Äç‚ôÄÔ∏è",
      "Vale um passeio surpresa! üöó",
      "Vale um caf√© especial! ‚òï",
      "Vale uma noite de filme juntos! üé¨"
    ];

    function mostrarMensagem() {
      let novoIndex;
      do {
        novoIndex = Math.floor(Math.random() * cupons.length);
      } while (novoIndex === ultimaMensagem);
      ultimaMensagem = novoIndex;
      message.textContent = cupons[novoIndex];
      message.classList.add('show');
    }

    function esconderMensagem() {
      message.classList.remove('show');
    }

    window.addEventListener('resize', ajustarPosicoes);
    window.addEventListener('load', () => {
      ajustarPosicoes();
      moverComTeclado();
    });
  </script>

</body>
</html>
